<html>
<!--<body background="images/back2.png">-->
<body onload="startTimer()">
	<head>
		<meta charset="utf-8">
		<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  		<link rel="stylesheet" type="text/css" href="stylesheets/style.css">
  		<script type="text/javascript" src="d3/d3.js"></script>
  		<script src="http://d3js.org/topojson.v1.min.js"></script>
		<title>02806 - Final Exam Project</title>
	</head>

	<div id="container">
		<!-- Landing page image -->
		<img id="top" src="images/Traffic_L.jpg" align="center" height="110%" width="100%"> 
  		<h1 id="text-top">New York City Traffic Data</h1>
		<div class="container">
			<div class="transbox"> 
				<!-- Adding and organizing all external scripts -->
				<h1>Motor Vehicle Incident Data in NYC</h1>
				<p>This page is created as the final part of the Exam Project in course 02806 - Social Data Analysis and Visualization, spring semester 2017. The data used for visualization is gathered from <a href="http://opendata.cityofnewyork.us//" target="_blank">New York City OpenData</a> and is used for learning purposes working with data driven visualizations in D3.</p>
				<p>The focus of this website is on visualization techniques using d3. The material used for the visualizations include summary statistics and machine learning methods. For more on the work behind the visualizations and references, see the bottom of this page.</p>

				<h2>What is this all about?</h2>
				<p>We have chosen to dig into one of the datasets publicly available from NYC OpenData. This specific dataset contains information about the motor vehicle collisions in New York City. The dataset contains information about traffic accidents from 2012-2017. For both 2012 and 2017, several months are missing, thus, this data is excluded from some of the plotting and analysis. In this range of years there are, a total of 1.007.310 observations. Among the different features of each observation, one can find information on where the accident happened as geo-locations, the parties involved in the acciden, cause of the accident (contributing factors to), people injured, time of day etc.</p>

				<p>With the visualization on this website, we will try and give the reader an understanding of how the traffic accidents are spread across NYC, the severity of the accidents, contributing factors to the accidents and through machine learning we will try to predict the reason for a given accident and try and see if the data seem to cluster in a specific way. In order to do this, we start out by visualizing a variety of different summary statistics followed by some more advanced data analysis using machine learning.</p>
				<p></p>
			</div>
		</div>

		<!-- Showing accidents plotted on heatmap -->
  		<div class="container">
			<div class="transbox">
				<h1>Getting to know the New York City traffic data</h1>
				<h2>Vehicle in collision and contributing factors</h2>
				<p>Below is plotted the total sum of all accidents per vehicle type for the range of the entire dataset. As can be seen fromt the plot, the vehicle type most commonly involved in traffic accidents is the passenger vehicle.</p>
				<p>It is without a doubt "Driver inattention/Distraction" that is the most common contributing factor in collisions in New York. As can be seen in the plot above, more than 25% of all accidents are due to driver inattention.. And the second most common reason is drowziness -- sure doesn't seem like the city that never sleeps!</p>

				<button type="button_small" id=	_toggle><p3>Toggle: primary vehicle/contributing factors</p3></button>
				<br></br>

				<!-- The data to visualize -->
				<center><div id="primary_vehicle"></div></center>

				<p>For the purpose of this assignment, we have chosen not to include all the accidents without an indication of which borough or for what reason the accident happened. This is discussed further in the <a href="http://nbviewer.jupyter.org/github/frksteenhoff/02806_SDA/blob/master/02806_FinalProject-ExplainerNotebook.ipynb" target="_blank">Notebook.</a></p>
				<p></p>
			</div>
		</div>
		

		<!-- Accident types -->
  		<div class="container">
			<div class="transbox">
				<h2>Vehicle collisions over time</h2>
				<p>Underneath is plotted the number of accidents per borough per year in monthly intervals. Choosing to plot the accidents per month is because of the large amount of data. Plotting data for longer ranges of time at the same time would make the visualizations very hard to read. 
				<br></br>
				<h2 id="text-on-geo">2012, July	</h1>
				<center><img id="img" src="images/geo/geo12_7.png" height="700" width="1400" title="Accidents per month for each year in dataset" /></center>
				<br></br>
				<p>Overall, the number of accidents have not decreased, actually there are more accidents in 2016, than in 2013, as can be seen from the plot below. What is interesting, is the number of people injured in accidents. This number has decreased steadily since 2013 significantly. If we look into the data (rightmost figure below), the number of accidents per year year </p>
				<br></br>
				<center>
					<div id="deaths_all"></div>					
				</center>

				<p> From this we can see that even though the number of accidents have risen the last years, the number of fatalities have fallen. No matter what that is an improvement!</p>
				<p></p>
			</div>
		</div>


		<!-- Number of accidents per borough -->
  		<div class="container">
			<div class="transbox">
				<h2>Accidents per hour of day</h2>
				<p>Now we have looked at the accidents overall foor each month per year, but what about the different times of the day? How does this look and might there be any patterns related to the time of day? Below is a graph showing the number of accidents for each hour of the day for each borough -- see the next borough by clicking the button.</p>

				<button type="button_small" id=year_toggle><p3>Click here for next borough</p3></button>
				<br></br>

				<!-- The incident data to visualize -->
				<center><div id="acc_all"></div></center>
				<p>Overall, there seems to be a pattern! For most of the boroughs, </p>
				<br></br>
			</div>
		</div>
		
		<!-- Geo-plotting -->
		<!-- K means data -->
  		<div class="container">
			<div class="transbox">
				<h2>K-means clustering</h2>
				<!-- The shapefile + clustering to visualize -->
				<center><div id="geo"></div></center>

				<!-- Buttons for toggling between different number of clusters -->
				<p><strong>Choose year for k-means visualization</strong><p>
				<div id='buttons'>
					<ul>
						<li><button class="buttonk" onclick="updateData(2013)"><p2>2013</p2></button></li>
						<li><button class="buttonk" onclick="updateData(2014)"><p2>2014</p2></button></li>
						<li><button class="buttonk" onclick="updateData(2015)"><p2>2015</p2></button></li>
						<li><button class="buttonk" onclick="updateData(2016)"><p2>2016</p2></button>
					</ul>
				</div>

				<p>Above is a visualization of every accident in may for the years 2013 through to 2016. The data has been clustered by K-means with 4 clusters. Once again we chose to include all the accidents despite of missing data values in some of the features. This does not have an influence on the clustering, as this is done solely by geolocation data.</p>
				<p>From the clustering we see that the density of accidents seem distributed with roughly the same clusters in 2014 to 2016. But for 2013 a cluster center is located on Staten Island. This could mean two things. Either there are significantly more accidents in Staten Island than year compared to others or there has been a significant increase in the number of accidents in the surrounding boroughs. From the visualization, the first option seems to be the cause even though the number of accidents are decreasing in Staten Island. The traffic accidents seem to be spread throughout Staten Island compared to the following years.</p>
				<p>What this change from 2013 to 2014 could indicate is that the road system has had a significant overhaul thus reducing the number of 'dangerous' road segments or maybe that simply less collisions have been reported. Either way a changed has occured that has reduced the number of traffic accidents reported in Staten Island </p>
				<br></br>
			</div>
		</div>

		<!-- NEW YORK CITY MAP-->
		<!--<img id="top" src="images/nyc_map.png" align="center" height="642" width="1931"> --> 	

		<!-- Some other machine learning model -->
  		<div class="container">
			<div class="transbox">
				<h2>Decision Tree</h2>
				<p>Predicting the contributing factor behind the accidents by use of the time of day, day of the week, vehicle type, number of persons killed and the borough in which the accident occured.</p>

				<!-- The decision tree to visualize -->
				<center><div id="tree"></div></center>
				<p>We decided to only predict on the 10 most common contributing factors of the accident to simplify the model. Furthermore we also decided to restrict the tree depth to 4, so that the model would be easier to visualze.</p>
				<p>The model ended up with test score of 35.77 % and a training score of 35.52 %. The score is a measure of the accuracy of the model - specifically the percent of observations in the data subsets the model predicted correctly. Randomly predicting a feature would score around 10 % accuracy as we have 10 different targets to predict for.</p>
			</div>
		</div>


		<!-- Some other machine learning model -->
  		<div class="container">
			<div class="transbox">
				<h2>What have we learned?</h2>
				<p>Adding some final comments to the work on this webpage.</p>
			</div>
		</div>

		<!-- Links to iPython Notebook, the source code and download option-->
		<br></br>
		<center><p_>__________________________________________________________________________________</p_></center>
		<br></br>
		<div id='buttons'>
			<ul>
				<li><button class="button">
					<a href="https://github.com/frksteenhoff/frksteenhoff.github.io/tree/master/FinalProject" target="_blank" data-tooltip="View source code"><img src="images/ic_code.svg" align="right" height="50" width="50"></a>
				</button></li>
				<li><button class="button">
					<a href="https://www.dropbox.com/s/ikjgrei4lkxayj3/Traffic_data.csv?dl=0" target="_blank" data-tooltip="Download dataset"><img src="images/ic_download.svg" align="right" height="50" width="50"></a>
				</button></li>
				<li><button class="button">
				  <a href="http://nbviewer.jupyter.org/github/frksteenhoff/02806_SDA/blob/master/02806_FinalProject-ExplainerNotebook.ipynb" target="_blank" data-tooltip="View iPython Notebook"><img src="images/ic_read.svg" align="right" height="50" width="50"></a>
				</button></li>
				<li><button class="button">
					<a href="https://www.youtube.com/watch?v=QFv7AFRmmTs" target="_blank" data-tooltip="View project video"><img src="images/ic_video.svg" align="right" height="50" width="50"></a>
				</button></li>
			</ul>
		</div>
	<br></br>
	</div>

	</body>
	<!-- SCRIPTS -->
	<script type="text/javascript" src="scripts/acc_per_hour.js"></script>
	<script type="text/javascript" src="scripts/vehicle_all.js"></script>
	<script type="text/javascript" src="scripts/image_display.js"></script>
	<script type="text/javascript" src="scripts/accidents_all.js"></script>
	<script type="text/javascript" src="scripts/deaths_all.js"></script>
	<script type="text/javascript" src="scripts/geo_nyc.js"></script>
	<script type="text/javascript" src="scripts/tree_visualization.js"></script>
</html>
